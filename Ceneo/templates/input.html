{% extends "base.html" %}

{% block content %}
<div class="container">
	<div class="row mb-2">
		<h3>Search for products</h3>
	</div>
	<div class="row mb-1">
		<div class="col-5"><label>Name of the product</label></div>
		<div class="col"><label>Quantity</label></div>
		<div class="col"><label>Min price</label></div>
		<div class="col"><label>Max price</label></div>
		<div class="col"><label>Min reputation</label></div>
	</div>

	<form name="inputForm" action="#" method="post" onsubmit="return validateForm()">
		{% for i in range(1, 6) %}
			<div class="row mb-3">
				<div class="col-5">
					<div class="input-group">
						<div class="input-group-prepend">
							<span class="input-group-text">{{i}}</span>
						</div>
						<input type="text" class="form-control" name="productName{{i}}">
					</div>
				</div>
				<div class="col">
					<input type="number" min="0" max="20" class="form-control" name="quantity{{i}}">
				</div>
				<div class="col">
					<input type="number" min="0" class="form-control" name="minPrice{{i}}">
				</div>
				<div class="col">
					<input type="number" min="0" class="form-control" name="maxPrice{{i}}">
				</div>
				<div class="col">
					<input type="number" min="1" max="5" class="form-control" name="reputation{{i}}">
				</div>
			</div>
		{% endfor %}

		<hr class="mb-3">
		<div class="mb-3 text-center">
			<button class="btn btn-primary btn-lg" style="width: 300px" type="submit">Search</button>
		</div>
	</form>
</div>
{% endblock %}

{% block script %}
<script>
	function validateForm(){
		var emptyFields = 0;
		for(var i=1; i<6; i++){
			var productName = document.forms["inputForm"]["productName" + i];
			var quantity = document.forms["inputForm"]["quantity" + i];
			var minPrice = document.forms["inputForm"]["minPrice" + i];
			var maxPrice = document.forms["inputForm"]["maxPrice" + i];

			if (productName.value == ""){
				emptyFields++;
			}

			if (productName.value == "" && quantity.value > 0){
				window.alert("Enter the name of product no " + i + ".");
				return false;
			}

			if (productName.value != "" && quantity.value == 0){
				window.alert("Enter the quantity of product no " + i + ".");
				return false;
			}

			if (minPrice.value > maxPrice.value){
				window.alert("Minimum price of product no " + i + " is higher than maximum.");
				return false;
			}
		}

		if(emptyFields == 5){
			window.alert("Enter at least one product.");
			return false;
		}

		return true;
	}
</script>
{% endblock %}